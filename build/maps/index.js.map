{"version":3,"sources":["index.js"],"names":["Tabs","props","state","data","select","start","selectData","showMenu","prepaireData","bind","createMenu","getContent","nextProps","nextState","that","propsItemClass","itemClass","menuData","contentData","forEach","item","ii","itemCls","push","index","path","title","idf","parent","attr","itemMethod","tabItemMethod","content","saxer","append","MenuData","ContentData","menu_data","get","treeMenu","tree","header","treeHeader","footer","treeFotter","MenuJsx","id","contents","_contents","selectContent","mulitple","list","jsxMenu","cls","tabClass","boxes_cls","React","Component","Aotoo","extend","params","utile","dft","undefined","merge","Action","UPDATE","ostate","opts","curState","SELECT","cb","setTimeout","myTabs","setProps","options","config"],"mappings":"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","file":"../index.js","sourcesContent":["/**\n * depends Aotoo as global variable\n */\n\nexport class Tabs extends React.Component {\n  constructor(props){\n    super(props)\n    this.state = {\n      data: this.props.data||[],\n      select: this.props.select||this.props.start||0,\n      selectData: {},\n      showMenu: this.props.showMenu,\n    }\n\n    this.prepaireData = this.prepaireData.bind(this)\n    this.createMenu = this.createMenu.bind(this)\n    this.getContent = this.getContent.bind(this)\n  }\n\n  componentWillMount() {\n    this.prepaireData(this.state)\n  }\n\n  componentWillUpdate(nextProps, nextState){\n    this.prepaireData(nextState)\n  }\n\n  /**\n   * [\n   *   {title, content, idf, parent, attr, path},\n   *   {title, content, idf, parent, attr, path},\n   * ]\n   */\n  prepaireData(state){\n    const that = this\n    const props = this.props\n    const propsItemClass = props.itemClass ? props.itemClass + ' ' : ''\n    let menuData = []\n    let contentData = []\n    state.data.forEach( (item, ii) => {\n      const itemCls = ii == state.select\n        ? item.itemClass ? propsItemClass+item.itemClass+' select' : propsItemClass+'select'\n        : item.itemClass ? propsItemClass+item.itemClass : propsItemClass\n\n      // 准备菜单数据\n      menuData.push({\n        index: ii,\n        path: item.path,\n        title: item.title,\n        idf: item.idf,\n        parent: item.parent,\n        attr: item.attr,\n        itemClass: itemCls,\n        itemMethod: item.tabItemMethod\n      })\n\n      // 准备内容数据\n      contentData.push({\n        index: ii,\n        path: item.path,\n        idf: item.idf,\n        content: item.content\n      })\n    })\n\n    this.saxer.append({\n      MenuData: menuData,\n      ContentData: contentData\n    })\n\n    this.createMenu()\n  }\n\n  createMenu(){\n    const menu_data = this.saxer.get().MenuData\n    const treeMenu = this.tree({\n      data: menu_data,\n      itemClass: this.props.itemClass,\n      itemMethod: this.props.tabItemMethod,\n      header: this.props.treeHeader,\n      footer: this.props.treeFotter\n    })\n\n    this.saxer.append({\n      MenuJsx: treeMenu\n    })\n  }\n\n  getContent(id){\n    const select = this.state.select\n    const contents = this.saxer.get().ContentData\n    let _contents = []\n    let selectContent\n\n    if (this.props.mulitple) {\n      contents.forEach( (item, ii) => {\n        if (!item.idf) {\n          _contents.push({\n            title: item.content,\n            itemClass: (id&&item.path&&item.path == id) ? 'select' : item.index == id ? 'select' : item.index == select ? 'select' : ''\n          })\n        }\n      })\n      return this.list({\n        data: _contents\n      })\n    }\n\n    contents.forEach( item => {\n      if ( (id||id==0)) {\n        if (item.path == id || item.index == id) {\n          selectContent = item.content\n        }\n      } else {\n        if (item.index == select) {\n          selectContent = item.content\n        }\n      }\n    })\n    return selectContent\n  }\n\n  render(){\n    const jsxMenu = this.saxer.get().MenuJsx\n    let content = this.getContent()\n    if (typeof content == 'function') {\n      content = content(this.state.selectData)\n    }\n\n    const cls = !this.props.tabClass ? 'tabsGroup ' : 'tabsGroup ' + this.props.tabClass\n    const boxes_cls = !this.props.mulitple ? 'tabsBoxes' : 'tabsBoxes mulitple'\n\n    return (\n      <div className={cls}>\n        { this.state.showMenu ? <div className='tabsMenus'>{jsxMenu}</div> : '' }\n        <div className={boxes_cls}>{content}</div>\n      </div>\n    )\n  }\n}\n\nAotoo.extend('tabs', function(params, utile){\n\n  let dft = {\n    props: {\n      tabClass: 'tabsGroupX',\n      mulitple: false,\n      tabItemMethod: undefined,\n      showMenu: true\n    }\n  }\n  if (params.props && params.props.itemMethod) {\n    params.props.tabItemMethod = params.props.itemMethod\n    delete params.props.itemMethod\n  }\n  dft = utile.merge({}, dft, params)\n\n  const Action = {\n    UPDATE: function(ostate, opts){\n      let state = this.curState\n      state.data = opts.data\n      return state\n    },\n    SELECT: function(ostate, opts){\n      let state = this.curState\n      state.select = opts.select\n      if (typeof opts.cb == 'function') {\n        setTimeout(function() {\n          opts.cb()\n        }, 100);\n      }\n      return state\n    },\n  }\n\n  const myTabs = Aotoo(Tabs, Action, dft)\n  myTabs.setProps = function(options){\n    if (options.itemMethod) {\n      options.tabItemMethod = options.itemMethod\n      delete options.itemMethod\n      myTabs.config = utile.merge({}, myTabs.config, {props: options})\n    }\n  }\n  return myTabs\n})\n\n\n\n// import css style\n// require('./tabs.styl')\n\n\n// demo\n// const WrapElement = Aotoo.wrap(\n//   <div>这个真好吃</div>, {\n//     rendered: function(dom){\n//       console.log('========= rendered');\n//     },\n//     leave: function(){\n//       console.log('========= leave');\n//     }\n//   }\n// )\n\n// function mkTabs(opts){\n//   const dft = {\n//     props: {\n//       mulitple: false,\n//       data: [],\n//       tabClass: 'tabs-nornal-top'\n//     }\n//   }\n//   // if (){}\n// }\n\n// const tabs = Aotoo.tabs({\n//   props: {\n//     mulitple: true,         //默认为false ,为true时，组件里所有content都会显示\n//     // tabClass: 'tabs-nornal',\n//     // tabClass: 'tabs-floor-left',\n//     tabClass: 'tabs-nornal-top',\n//     data: [\n//       // {title: 'aaa', content: '什么', idf: 'le1', itemClass: 'aabbcc'},\n//       {title: 'aaa', content: '什么, what'},\n//       {title: 'bbb', content: '来了'},\n//       {title: 'ccc', content: <WrapElement />},\n//     ]\n//   }\n// })\n\n\n// const $ = require('jquery')\n// // //用于tabs-floor-left\n// // tabs.render('test', function(dom){\n// //   $(dom).find('.tabsMenus li:not(.itemroot)').click(function(){\n// //     let index = $(this).attr('data-treeid')\n// //     let num = parseInt(index) + 1\n// //     tabs.$select({\n// //       select: index\n// //     })\n// //     let target_top = $(this).parents('.tabsMenus').next('.mulitple').find('>ul>li:nth-child('+num+')').offset().top\n// //     $(\"html,body\").animate({scrollTop: target_top}, 500)\n// //   })\n// // })\n// tabs.render('test', function(dom){\n//   $(dom).find('.tabsMenus li:not(.itemroot)').click(function(){\n//     let index = $(this).attr('data-treeid')\n//     let num = parseInt(index) + 1     // mlitple = false  ,tabClass: 'tabs-nornal-top',\n//     tabs.$select({\n//       select: index,\n//       cb: function(){ }\n//     })\n//     // let target_top = $(this).parents('.tabsMenus').next('.tabsBoxes').offset().top     //适合于 mlitple = true，tabClass: 'tabs-nornal-top',\n//     let target_top = $(this).parents('.tabsMenus').next('.mulitple').find('>ul>li:nth-child('+num+')').offset().top - 50   // mlitple = false    50是tabsMenus的高度，tabClass: 'tabs-nornal-top',\n//     $(\"html,body\").animate({scrollTop: target_top}, 500)  //适合于 mlitple = true与false，tabClass: 'tabs-nornal-top',\n//   })\n// })\n"]}