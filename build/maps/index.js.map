{"version":3,"sources":["index.js"],"names":["TabsMenus","props","myProps","propsData","data","forEach","className","item","itemClass","replace","index","select","path","push","Tabs","state","start","selectData","showMenu","prepaireData","bind","createMenu","getContent","that","menuData","contentData","ii","title","idf","parent","attr","itemMethod","tabItemMethod","content","saxer","append","MenuData","ContentData","menu_data","get","navItemMethod","tapItemMethod","id","contents","stateContents","_contents","selectContent","mulitple","thisConfig","config","jsxMenu","myJsxMenu","treeHeader","treeFooter","iscrollConfig","cls","tabClass","boxes_cls","React","Component","Aotoo","extend","params","utile","dft","undefined","merge","Action","UPDATE","ostate","opts","curState","SELECT","cb","setTimeout","myTabs","setProps","options","on","dom","refs","context","window","$iscroll","require","scrollMenu","tabsMenus"],"mappings":"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","file":"../index.js","sourcesContent":["// require('aotoo-mixins-iscroll')\n\nconst TabsMenus = (props) => {\n  let myProps = {...props}\n  const propsData = []\n  myProps.data.forEach( item => {\n    const className = (item.itemClass||'').replace(/ *select/g, '')\n    if (item.index == myProps.select || item.path == myProps.select) {\n      item.itemClass = className ? className + \" select\" : \"select\"\n    } else {\n      item.itemClass = className.replace(/( *)select/g, '')\n    }\n    propsData.push(item)\n    return item\n  })\n  myProps.data = propsData\n  return <Aotoo.tree {...myProps}/>\n}\n\nexport class Tabs extends React.Component {\n  constructor(props){\n    super(props)\n    this.state = {\n      data: this.props.data||[],\n      select: this.props.select||this.props.start||0,\n      selectData: {},\n      showMenu: this.props.showMenu,\n    }\n\n    this.prepaireData = this.prepaireData.bind(this)\n    this.createMenu = this.createMenu.bind(this)\n    this.getContent = this.getContent.bind(this)\n  }\n\n  componentWillMount() {\n    this.prepaireData(this.state)\n  }\n  \n  prepaireData(state){\n    const that = this\n    const props = this.props\n    \n    let menuData = []\n    let contentData = []\n    state.data.forEach( (item, ii) => {\n      // 准备菜单数据\n      menuData.push({\n        index: ii,\n        path: item.path,\n        title: item.title,\n        idf: item.idf,\n        parent: item.parent,\n        attr: item.attr,\n        itemClass: props.itemClass,\n        itemMethod: props.tabItemMethod || props.itemMethod\n      })\n\n      // 准备内容数据\n      contentData.push({\n        index: ii,\n        path: item.path,\n        idf: item.idf,\n        content: item.content\n      })\n    })\n\n    this.saxer.append({\n      MenuData: menuData,\n      ContentData: contentData\n    })\n  }\n\n  createMenu(){\n    const props = this.props\n    const menu_data = this.saxer.get().MenuData\n    return <TabsMenus\n      data={menu_data}\n      itemClass={props.itemClass}\n      itemMethod={props.navItemMethod || props.tapItemMethod || props.tabItemMethod || props.itemMethod}\n      select={this.state.select}\n    />\n  }\n\n  getContent(id){\n    const select = this.state.select\n    const contents = this.saxer.get().ContentData\n    const stateContents = this.state.data\n    let _contents = []\n    let selectContent\n\n    if (this.props.mulitple) {\n      contents.forEach( (item, ii) => {\n        if (!item.idf) {\n          _contents.push({\n            title: item.content,\n            itemClass: (id && item.path && item.path == id) ? 'select' : item.index == id ? 'select' : (item.index == select || item.path == select) ? 'select' : ''\n          })\n        }\n      })\n      return <Aotoo.list data={_contents}/>\n    }\n\n    contents.forEach( item => {\n      if ( (id||id==0)) {\n        if (item.path == id || item.index == id) {\n          selectContent = item.content || stateContents[item.index]['content']\n        }\n      } else {\n        if (item.index == select || item.path == select) {\n          selectContent = item.content || stateContents[item.index]['content']\n        }\n      }\n    })\n    return selectContent\n  }\n\n  render(){\n    let thisConfig = this.config\n    let props = this.props\n    let content = this.getContent()\n    let jsxMenu = this.createMenu()\n    let myJsxMenu = <div ref=\"tabsMenus\" className='tabsMenus'>{props.treeHeader}{jsxMenu}{props.treeFooter}</div>\n    if (thisConfig.iscrollConfig) {\n      myJsxMenu = (\n        <div className='tabsMenus'>\n          {props.treeHeader}\n          <div ref=\"tabsMenus\" className=\"innerWrap\">\n            {jsxMenu}\n          </div>\n          {props.treeFooter}\n        </div>\n      )\n    } \n\n    // let thisConfig = this.config\n    // if (thisConfig.iscrollConfig && typeof thisConfig.iscrollConfig == 'object') {\n    //   let IscrollTreeMenu = Aotoo.iscroll(\n    //     <div className='tabsMenus'>{jsxMenu}</div>, \n    //     thisConfig.iscrollConfig\n    //   )\n    //   myJsxMenu = <IscrollTreeMenu />\n    // }\n\n    if (typeof content == 'function') {\n      content = content(this.state.selectData)\n    }\n\n    const cls = !this.props.tabClass ? 'tabsGroup ' : 'tabsGroup ' + this.props.tabClass\n    const boxes_cls = !this.props.mulitple ? 'tabsBoxes' : 'tabsBoxes mulitple'\n\n    return (\n      <div ref=\"tabsGroup\" className={cls}>\n        { this.state.showMenu ? myJsxMenu : '' }\n        <div ref=\"tabsBoxes\" className={boxes_cls}>{content}</div>\n      </div>\n    )\n  }\n}\n\nAotoo.extend('tabs', function(params, utile){\n  let dft = {\n    props: {\n      tabClass: 'tabsGroupX',\n      mulitple: false,\n      tabItemMethod: undefined,\n      showMenu: true\n    },\n    iscrollConfig: undefined\n  }\n  if (params && params.props && params.props.itemMethod) {\n    params.props.tabItemMethod = params.props.itemMethod\n    delete params.props.itemMethod\n  }\n  dft = utile.merge({}, dft, params)\n\n  const Action = {\n    UPDATE: function(ostate, opts){\n      let state = this.curState\n      state.data = opts.data\n      return state\n    },\n    SELECT: function(ostate, opts={}){\n      let state = this.curState\n      if (typeof opts=='string' || typeof opts=='number') {\n        opts = {select: opts}\n      }\n      state.select = opts.select\n      state.selectData = opts.selectData\n      if (typeof opts.cb == 'function') {\n        setTimeout(function() {\n          opts.cb()\n        }, 50);\n      }\n      return state\n    },\n  }\n\n  const myTabs = Aotoo(Tabs, Action, dft)\n  myTabs.setProps = function(options){\n    if (options.itemMethod) {\n      options.tabItemMethod = options.itemMethod\n      delete options.itemMethod\n      myTabs.config = utile.merge({}, myTabs.config, {props: options})\n    }\n  }\n  myTabs.on('__beforeRendered', function (opts) {\n    const {dom, refs, context} = opts\n    if (typeof window != 'undefined' && dft.iscrollConfig) {\n      var $iscroll = require('iscroll/build/iscroll-probe')\n      context.scrollMenu = new $iscroll(refs.tabsMenus, dft.iscrollConfig)\n    }\n  })\n  return myTabs\n})"]}